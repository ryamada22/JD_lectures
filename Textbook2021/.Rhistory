p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p_LRtest
n.iter <- 1000
p.t <- p.LR <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
p.t[i] <- t.test(X ~ Cell, var.equal = FALSE,data=df)$p.value
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=3,lower.tail=FALSE)
p.LR[i] <- p_LRtest
}
plot(p.t,p.LR)
n.iter <- 1000
p.t <- p.LR <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
p.t[i] <- t.test(X ~ Cell, var.equal = FALSE,data=df)$p.value
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p.LR[i] <- p_LRtest
}
plot(p.t,p.LR)
# 細胞数
N1 <- 500
N2 <- 600
# ２群の平均
m1 <- 20
m2 <- 20.1
# ２群の標準偏差(等分散)
s1 <- 3
s2 <- 3.3
# データ生成
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
t.test(X ~ Cell, var.equal = FALSE,data=df)
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p_LRtest
n.iter <- 1000
p.t <- p.LR <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
p.t[i] <- t.test(X ~ Cell, var.equal = FALSE,data=df)$p.value
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p.LR[i] <- p_LRtest
}
plot(p.t,p.LR)
n.iter <- 1000
p.t <- p.LR <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
p.t[i] <- t.test(X ~ Cell, var.equal = FALSE,data=df)$p.value
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1_1 <- dnorm(X1,est_m_0,est_s_01)
L1_2 <- dnorm(X2,est_m_0,est_s_02)
LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p.LR[i] <- p_LRtest
}
plot(p.t,p.LR)
n.iter <- 1000
p.t <- p.LR <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
p.t[i] <- t.test(X ~ Cell, var.equal = FALSE,data=df)$p.value
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1_1 <- dnorm(X1,est_m_0,est_s_01)
L1_2 <- dnorm(X2,est_m_0,est_s_02)
LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=1,lower.tail=FALSE)
p.LR[i] <- p_LRtest
}
plot(p.t,p.LR)
# 細胞数
N1 <- 50
N2 <- 60
# ２群の平均
m1 <- 20
m2 <- 20.1
# ２群の標準偏差(等分散)
s1 <- 3
s2 <- 3.3
# データ生成
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
t.test(X ~ Cell, var.equal = FALSE,data=df)
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- drnorm(X,est_m_0,est_s_0)
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
#L1_1 <- dnorm(X1,est_m_0,est_s_01)
#L1_2 <- dnorm(X2,est_m_0,est_s_02)
#LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
print(K)
p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p_LRtest
n.iter <- 1000
p.t <- p.LR <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
p.t[i] <- t.test(X ~ Cell, var.equal = FALSE,data=df)$p.value
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
#L1_1 <- dnorm(X1,est_m_0,est_s_01)
#L1_2 <- dnorm(X2,est_m_0,est_s_02)
#LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=1,lower.tail=FALSE)
p.LR[i] <- p_LRtest
}
plot(p.t,p.LR)
n.iter <- 1000
p.t <- p.LR <- ts <- Ks <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
t.out <- t.test(X ~ Cell, var.equal = FALSE,data=df)
p.t[i] <- t.out$p.value
ts[i] <- t.out$statistics
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
#L1_1 <- dnorm(X1,est_m_0,est_s_01)
#L1_2 <- dnorm(X2,est_m_0,est_s_02)
#LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=1,lower.tail=FALSE)
p.LR[i] <- p_LRtest
Ks[i] <- K
}
t.out
n.iter <- 1000
p.t <- p.LR <- ts <- Ks <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
t.out <- t.test(X ~ Cell, var.equal = FALSE,data=df)
p.t[i] <- t.out$p.value
ts[i] <- t.out$statistic
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
#L1_1 <- dnorm(X1,est_m_0,est_s_01)
#L1_2 <- dnorm(X2,est_m_0,est_s_02)
#LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=1,lower.tail=FALSE)
p.LR[i] <- p_LRtest
Ks[i] <- K
}
plot(p.t,p.LR)
plot(Ks,ts)
# 細胞数
N1 <- 50
N2 <- 60
# ２群の平均
m1 <- 20
m2 <- 20
# ２群の標準偏差(等分散)
s1 <- 3
s2 <- 3
# データ生成
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
t.test(X ~ Cell, var.equal = FALSE,data=df)
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
#L1_1 <- dnorm(X1,est_m_0,est_s_01)
#L1_2 <- dnorm(X2,est_m_0,est_s_02)
#LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
print(K)
p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p_LRtest
n.iter <- 1000
p.t <- p.LR <- ts <- Ks <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
t.out <- t.test(X ~ Cell, var.equal = FALSE,data=df)
p.t[i] <- t.out$p.value
ts[i] <- t.out$statistic
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
#L1_1 <- dnorm(X1,est_m_0,est_s_01)
#L1_2 <- dnorm(X2,est_m_0,est_s_02)
#LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=1,lower.tail=FALSE)
p.LR[i] <- p_LRtest
Ks[i] <- K
}
plot(p.t,p.LR)
plot(sort(p.t))
plot(sort(p.LR))
plot(ts,Ks)
n.iter <- 1000
p.t <- p.LR <- ts <- Ks <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
t.out <- t.test(X ~ Cell, var.equal = FALSE,data=df)
p.t[i] <- t.out$p.value
ts[i] <- t.out$statistic
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
#L1_1 <- dnorm(X1,est_m_0,est_s_01)
#L1_2 <- dnorm(X2,est_m_0,est_s_02)
#LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p.LR[i] <- p_LRtest
Ks[i] <- K
}
plot(p.t,p.LR)
n.iter <- 1000
p.t <- p.LR <- ts <- Ks <- rep(NA,n.iter)
for(i in 1:n.iter){
X1 <- rnorm(N1,m1,s1)
X2 <- rnorm(N2,m2,s2)
X <- c(X1,X2)
Cell <- c(rep(1,N1),rep(2,N2))
df <- data.frame(Cell,X)
# t-検定
t.out <- t.test(X ~ Cell, var.equal = FALSE,data=df)
p.t[i] <- t.out$p.value
ts[i] <- t.out$statistic
# LR-test
est_m_0 <- mean(X)
est_s_0 <- sd(X)
est_s_01 <- sqrt(sum(X1-est_m_0)^2)
est_s_02 <- sqrt(sum(X2-est_m_0)^2)
est_m_1 <- mean(X1)
est_s_1 <- sd(X1)
est_m_2 <- mean(X2)
est_s_2 <- sd(X2)
L1 <- dnorm(X,est_m_0,est_s_0)
LL1 <- sum(log(L1))
#L1_1 <- dnorm(X1,est_m_0,est_s_01)
#L1_2 <- dnorm(X2,est_m_0,est_s_02)
#LL1 <- sum(log(L1_1)) + sum(log(L1_2))
L2_1 <- dnorm(X1,est_m_1,est_s_1)
L2_2 <- dnorm(X2,est_m_2,est_s_2)
LL2 <- sum(log(L2_1)) + sum(log(L2_2))
K <- 2 * (LL2 - LL1)
p_LRtest <- pchisq(K,df=2,lower.tail=FALSE)
p.LR[i] <- p_LRtest
Ks[i] <- K
}
plot(p.t,p.LR)
plot(sort(p.t))
plot(sort(p.LR))
N <- 100
X <- rnorm(N,20,2)
a <- 2.3
b <- 4.5
Y <- a * X + b + rnorm(N,0,3)
plot(X,Y)
N <- 100
X <- rnorm(N,20,2)
a <- 2.3
b <- 4.5
Y <- a * X + b + rnorm(N,0,3)
plot(X,Y)
# 線形回帰
lm.out <- lm(Y~X)
lm.out$coefficients
# 線形回帰
lm.out <- lm(Y~X)
lm.out$coefficients
plot(X,Y,pch=20)
abline(lm.out$coefficients[1],lm.out$coefficients[2],col=2)
N <- 100
X <- rnorm(N,20,2)
a <- 2.3
b <- 4.5
Y <- a * X + b + rnorm(N,0,0.1)
plot(X,Y,pch=20)
# 線形回帰
lm.out <- lm(Y~X)
lm.out$coefficients
plot(X,Y,pch=20)
abline(lm.out$coefficients[1],lm.out$coefficients[2],col=2)
N <- 100
X <- rnorm(N,20,2)
a <- 2.3
b <- 4.5
Y <- a * X + b + rnorm(N,0,0.5)
plot(X,Y,pch=20)
# 線形回帰
lm.out <- lm(Y~X)
lm.out$coefficients
plot(X,Y,pch=20)
abline(lm.out$coefficients[1],lm.out$coefficients[2],col=2)
